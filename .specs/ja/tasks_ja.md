# 実装計画

- [ ] 1. プロジェクト構造とコア設定のセットアップ
  - TypeScriptと必要な依存関係を含むNext.jsプロジェクトを作成
  - Tailwind CSS、ESLint、Prettierを設定
  - Dockerマルチステージビルド設定をセットアップ
  - 適切なボリュームとネットワーキングを含むDocker Compose設定を作成
  - _要件: 10.1, 10.2_

- [ ] 2. データベース層とコアモデルの実装
  - [ ] 2.1 スキーマ付きSQLiteデータベースのセットアップ
    - データベース初期化スクリプトを作成
    - データベース接続ユーティリティを実装
    - servers、configurations、secrets、test_resultsテーブル用SQLスキーマを定義
    - _要件: 1.1, 2.1, 3.1, 7.1_

  - [ ] 2.2 TypeScriptインターフェースとデータモデルの作成
    - MCPServer、ServerConfiguration、Tool、Secret、TestResultインターフェースを定義
    - 適切なエラーハンドリングを含むデータベースアクセス層を実装
    - データ操作用のリポジトリパターンを作成
    - _要件: 1.1, 2.1, 3.1, 7.1_

- [ ] 3. Docker MCP統合層の実装
  - [ ] 3.1 DockerMCPClientクラスの作成
    - docker mcp CLIコマンドを実行するメソッドを実装
    - サーバーリスト、詳細取得、ステータス管理を追加
    - サーバー有効化/無効化とゲートウェイ制御機能を実装
    - _要件: 1.1, 1.2, 2.1, 3.4_

  - [ ] 3.2 ログ取得と監視の実装
    - リアルタイム更新用のログストリーミング機能を作成
    - ログフィルタリングと検索機能を実装
    - ログファイルダウンロード機能を追加
    - _要件: 5.1, 5.2, 5.3, 5.4_

  - [ ] 3.3 カタログ統合の作成
    - MCPサーバーカタログアクセス用CatalogClientを実装
    - カタログからのサーバーインストール機能を追加
    - インストール進捗追跡を作成
    - _要件: 6.1, 6.2, 6.3, 6.4_

- [ ] 4. 認証システムの実装
  - [ ] 4.1 NextAuth.js設定のセットアップ
    - JWTベース認証を設定
    - カスタムログインプロバイダーを実装
    - セッション管理ユーティリティを作成
    - _要件: 9.1, 9.2, 9.3_

  - [ ] 4.2 認証用Bitwarden CLI統合の追加
    - Bitwarden CLIラッパーを実装
    - Bitwarden認証情報を使用した認証フローを作成
    - フォールバック認証方法を追加
    - _要件: 9.4_

- [ ] 5. APIエンドポイントの作成
  - [ ] 5.1 サーバー管理APIルートの実装
    - CRUD操作用/api/serversエンドポイントを作成
    - サーバー開始/停止機能を追加
    - サーバー設定更新エンドポイントを実装
    - _要件: 1.1, 1.2, 2.1, 3.1, 3.2, 3.4_

  - [ ] 5.2 カタログとインストールAPIルートの作成
    - サーバー閲覧用/api/catalogエンドポイントを実装
    - 進捗追跡付きインストールAPIを追加
    - カタログからのサーバー詳細取得を作成
    - _要件: 6.1, 6.2, 6.3, 6.4_

  - [ ] 5.3 テストとログAPIルートの実装
    - ツールテスト用/api/servers/[id]/testエンドポイントを作成
    - テスト履歴取得機能を追加
    - Server-Sent Eventsを使用したログストリーミングAPIを実装
    - _要件: 4.1, 4.2, 4.3, 4.4, 5.1, 5.2, 5.3, 5.4_

  - [ ] 5.4 設定管理APIルートの作成
    - /api/config/exportと/api/config/importエンドポイントを実装
    - 暗号化付き機密情報管理APIを追加
    - Bitwarden統合エンドポイントを作成
    - _要件: 7.1, 7.2, 7.3, 7.4, 8.1, 8.2, 8.3, 8.4_

- [ ] 6. 機密情報管理システムの実装
  - [ ] 6.1 暗号化ユーティリティの作成
    - 機密データ用AES-256暗号化を実装
    - 安全なキー管理システムを作成
    - 適切なエラーハンドリング付き暗号化/復号化ユーティリティを追加
    - _要件: 7.1, 7.4_

  - [ ] 6.2 Bitwarden CLI統合の実装
    - 機密情報取得用Bitwarden CLIラッパーを作成
    - 機密情報同期機能を実装
    - Bitwarden認証とセッション管理を追加
    - _要件: 7.3_

- [ ] 7. フロントエンドコンポーネントとページの作成
  - [ ] 7.1 認証コンポーネントの実装
    - 検証付きLoginFormコンポーネントを作成
    - グローバル認証状態用AuthProviderを実装
    - セキュアページ用ProtectedRouteラッパーを作成
    - _要件: 9.1, 9.2, 9.3, 9.4_

  - [ ] 7.2 ダッシュボードとサーバーリストコンポーネントの構築
    - リアルタイムステータス更新付きServerListコンポーネントを作成
    - ステータスインジケーター付きServerCardコンポーネントを実装
    - サーバーフィルタリングと検索機能を追加
    - _要件: 1.1, 1.2, 1.3, 1.4_

  - [ ] 7.3 サーバー詳細と設定コンポーネントの作成
    - 包括的な情報表示付きServerDetailコンポーネントを実装
    - サーバー設定管理用ConfigurationFormを作成
    - ツール管理用ToolSelectorコンポーネントを追加
    - _要件: 2.1, 2.2, 2.3, 2.4, 3.1, 3.2, 3.3, 3.4_

  - [ ] 7.4 テストと監視コンポーネントの実装
    - ツール実行用TestRunnerコンポーネントを作成
    - リアルタイム更新とフィルタリング付きLogViewerを実装
    - リソース使用状況可視化用MetricsDisplayを追加
    - _要件: 4.1, 4.2, 4.3, 4.4, 5.1, 5.2, 5.3, 5.4_

  - [ ] 7.5 カタログとインストールコンポーネントの構築
    - サーバー発見用CatalogBrowserを作成
    - インストールワークフロー付きServerInstallerを実装
    - 追跡用InstallationProgressコンポーネントを追加
    - _要件: 6.1, 6.2, 6.3, 6.4_

  - [ ] 7.6 設定管理コンポーネントの作成
    - 設定管理用ImportExportコンポーネントを実装
    - 安全な認証情報処理用SecretsManagerを作成
    - BitwardenIntegrationコンポーネントを追加
    - _要件: 7.1, 7.2, 7.3, 7.4, 8.1, 8.2, 8.3, 8.4_

- [ ] 8. エラーハンドリングと検証の実装
  - [ ] 8.1 グローバルエラーハンドリングシステムの作成
    - コンポーネントエラーハンドリング用Reactエラーバウンダリを実装
    - グローバルエラー状態管理を作成
    - ユーザーフィードバック用トースト通知システムを追加
    - _要件: 全要件 - エラーハンドリング_

  - [ ] 8.2 入力検証とサニタイゼーションの追加
    - Zodスキーマを使用した包括的な入力検証を実装
    - APIリクエスト/レスポンス検証を追加
    - ユーザー入力用サニタイゼーションユーティリティを作成
    - _要件: 3.1, 3.3, 8.2, 8.3_

- [ ] 9. テストインフラストラクチャの追加
  - [ ] 9.1 ユニットテストフレームワークのセットアップ
    - JestとReact Testing Libraryを設定
    - Docker統合用テストユーティリティとモックを作成
    - コアコンポーネントとユーティリティのユニットテストを実装
    - _要件: 全要件 - テストカバレッジ_

  - [ ] 9.2 統合テストの実装
    - APIエンドポイント用統合テストを作成
    - データベース操作テストを追加
    - Docker MCP CLI統合テストを実装
    - _要件: 全要件 - 統合テスト_

  - [ ] 9.3 エンドツーエンドテストの追加
    - E2Eテスト用Playwrightをセットアップ
    - 主要機能のユーザーワークフローテストを作成
    - Docker環境での自動テストを実装
    - _要件: 全要件 - E2Eテスト_

- [ ] 10. 本番最適化の実装
  - [ ] 10.1 パフォーマンス最適化の追加
    - 効率的なデータ取得用React Queryを実装
    - APIレスポンス用適切なキャッシュ戦略を追加
    - バンドルサイズを最適化し、コード分割を実装
    - _要件: 1.2, 2.1, 5.1_

  - [ ] 10.2 セキュリティ強化の実装
    - APIエンドポイント用レート制限を追加
    - 適切なCORS設定を実装
    - セキュリティヘッダーとCSPポリシーを追加
    - _要件: 7.1, 7.2, 9.1, 9.2, 9.3_

  - [ ] 10.3 監視とログの追加
    - アプリケーション全体で構造化ログを実装
    - コンテナ監視用ヘルスチェックエンドポイントを追加
    - アプリケーションメトリクスと監視を作成
    - _要件: 5.1, 5.2, 5.3, 5.4_

- [ ] 11. ドキュメントとデプロイメントセットアップの作成
  - [ ] 11.1 包括的なドキュメントの作成
    - セットアップと使用方法を含むREADMEを作成
    - APIエンドポイントとデータモデルをドキュメント化
    - トラブルシューティングガイドとFAQを追加
    - _要件: 10.1, 10.2, 10.3, 10.4_

  - [ ] 11.2 Dockerデプロイメント設定の最終化
    - 本番ビルド用Dockerfileを最適化
    - 適切なボリュームマウントとデータ永続化を確保
    - 完全なDocker Composeデプロイメントワークフローをテスト
    - _要件: 10.1, 10.2, 10.3, 10.4_